<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Live TV | IPTV Watch</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Video.js -->
  <link href="https://vjs.zencdn.net/8.6.1/video-js.css" rel="stylesheet" />

  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4898030606400937"
     crossorigin="anonymous"></script>

  <style>
    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      background: #0f172a;
      color: #fff;
    }

    header {
      background: #020617;
      padding: 15px;
      text-align: center;
      font-size: 22px;
      font-weight: bold;
    }

    .container {
      display: flex;
      height: calc(100vh - 60px);
    }

    .sidebar {
      width: 300px;
      background: #020617;
      border-right: 1px solid #1e293b;
      overflow-y: auto;
    }

    .sidebar input {
      width: 90%;
      margin: 10px;
      padding: 8px;
      border-radius: 6px;
      border: none;
      outline: none;
    }

    .channel {
      padding: 10px;
      cursor: pointer;
      border-bottom: 1px solid #1e293b;
    }

    .channel:hover {
      background: #1e293b;
    }

    .player-section {
      flex: 1;
      padding: 10px;
    }

    .video-js {
      width: 100%;
      height: 60vh;
    }

    .ads {
      margin-top: 10px;
      text-align: center;
    }

    @media (max-width: 768px) {
      .container {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        height: 250px;
      }
    }
  </style>
</head>
<body>

<header>ðŸ“º Free Live IPTV Channels</header>

<div class="container">
  <!-- Channel List -->
  <div class="sidebar">
    <input type="text" id="search" placeholder="Search channel..." />
    <div id="channels"></div>
  </div>

  <!-- Player -->
  <div class="player-section">
    <video id="player" class="video-js vjs-default-skin" controls autoplay></video>

    <!-- Ad Section -->
    <div class="ads">
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-4898030606400937"
           data-ad-slot="1234567890"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>
  </div>
</div>

<!-- Video.js -->
<script src="https://vjs.zencdn.net/8.6.1/video.min.js"></script>

<script>
const M3U_URL = "https://iptv-org.github.io/iptv/index.m3u";
const channelContainer = document.getElementById("channels");
const searchInput = document.getElementById("search");
const player = videojs("player");

let channels = [];

fetch(M3U_URL)
  .then(res => res.text())
  .then(data => parseM3U(data));

function parseM3U(data) {
  const lines = data.split("\n");
  for (let i = 0; i < lines.length; i++) {
    if (lines[i].startsWith("#EXTINF")) {
      const name = lines[i].split(",")[1];
      const url = lines[i + 1];
      channels.push({ name, url });
    }
  }
  renderChannels(channels);
}

function renderChannels(list) {
  channelContainer.innerHTML = "";
  list.forEach(ch => {
    const div = document.createElement("div");
    div.className = "channel";
    div.innerText = ch.name;
    div.onclick = () => playChannel(ch.url);
    channelContainer.appendChild(div);
  });
}

function playChannel(url) {
  player.src({
    src: url,
    type: "application/x-mpegURL"
  });
  player.play();
}

searchInput.addEventListener("input", () => {
  const q = searchInput.value.toLowerCase();
  const filtered = channels.filter(c =>
    c.name.toLowerCase().includes(q)
  );
  renderChannels(filtered);
});
</script>

</body>
</html>
